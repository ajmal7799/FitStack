"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.authMiddleware = exports.adminAuthController = exports.userAuthController = void 0;
const userModel_1 = require("../../database/models/userModel");
const userRepository_1 = require("../../repositories/userRepository");
const hashPasswordService_1 = require("../../services/hashPasswordService");
const signupUserUseCase_1 = require("../../../application/implementation/auth/user/signupUserUseCase");
const userAuthController_1 = require("../../../interfaceAdapters/controller/auth/userAuthController");
const otpService_1 = require("../../services/otpService");
const otpEmailContentGenerator_1 = require("../../services/Email/EmailContentGenerator/otpEmailContentGenerator");
const emailService_1 = require("../../services/Email/emailService");
const signUpSendOtpUseCase_1 = require("../../../application/implementation/auth/user/signUpSendOtpUseCase");
const verifyOtpUseCase_1 = require("../../../application/implementation/auth/verifyOtpUseCase");
const KeyValueTTLCaching_1 = require("../../cache/redis/KeyValueTTLCaching");
const jwtService_1 = require("../../services/jwtService");
const tokenCreationUseCase_1 = require("../../../application/implementation/auth/tokenCreationUseCase");
const loginUserUseCase_1 = require("../../../application/implementation/auth/user/loginUserUseCase");
const authMiddleware_1 = require("../../../interfaceAdapters/middleware/authMiddleware");
const AdminLoginUseCase_1 = require("../../../application/implementation/auth/admin/AdminLoginUseCase");
const adminAuthController_1 = require("../../../interfaceAdapters/controller/auth/adminAuthController");
const tokenInvalidationUseCase_1 = require("../../../application/implementation/auth/tokenInvalidationUseCase");
const resendOtpUseCase_1 = require("../../../application/implementation/auth/resendOtpUseCase");
const forgetPasswordSentOtp_1 = require("../../../application/implementation/auth/forgetPasswordSentOtp");
const forgetPasswordVerifyOtpUseCase_1 = require("../../../application/implementation/auth/forgetPasswordVerifyOtpUseCase");
const tokenService_1 = require("../../services/tokenService");
const forgetPasswordResetPassword_1 = require("../../../application/implementation/auth/forgetPasswordResetPassword");
const trainerRepository_1 = require("../../repositories/trainerRepository");
const trainerModel_1 = require("../../database/models/trainerModel");
const googleAuthService_1 = require("../../services/googleAuthService");
const userGoogleLoginUseCase_1 = require("../../../application/implementation/auth/userGoogleLoginUseCase");
const userProfileRepository_1 = require("../../repositories/userProfileRepository");
const userProfileModel_1 = require("../../database/models/userProfileModel");
//Repositories & Services
const userRepository = new userRepository_1.UserRepository(userModel_1.userModel);
const hashService = new hashPasswordService_1.HashPassword();
const otpService = new otpService_1.OtpService();
const otpContentGenerator = new otpEmailContentGenerator_1.OtpEmailContentGenerator();
const emailService = new emailService_1.EmailService();
const cacheStorage = new KeyValueTTLCaching_1.KeyValueTTLCaching();
const jwtService = new jwtService_1.JWTService();
const tokenService = new tokenService_1.TokenSerivce();
const trainerRepository = new trainerRepository_1.TrainerRepository(trainerModel_1.trainerModel);
const googleAuthService = new googleAuthService_1.GoogleAuthService();
const userProfileRepository = new userProfileRepository_1.UserProfileRepository(userProfileModel_1.userProfileModel);
//UseCases
const registerUserUseCase = new signupUserUseCase_1.RegisterUserUseCase(userRepository, hashService);
const userSendOtpUseCase = new signUpSendOtpUseCase_1.SignUpSendOtpUseCase(otpService, otpContentGenerator, emailService, userRepository, cacheStorage);
const verifyOtpUseCase = new verifyOtpUseCase_1.VerifyOtpUseCase(cacheStorage);
const tokenCreationUseCase = new tokenCreationUseCase_1.TokenCreationUseCase(jwtService);
const userLoginUseCase = new loginUserUseCase_1.UserLoginUseCase(userRepository, hashService, trainerRepository, userProfileRepository);
const adminLoginUseCase = new AdminLoginUseCase_1.AdminLoginUseCase(userRepository, hashService);
const tokenValidationUseCase = new tokenInvalidationUseCase_1.TokenInvalidationUseCase(jwtService, cacheStorage);
const resendOtpUseCase = new resendOtpUseCase_1.ResendOtpUseCase(otpService, otpContentGenerator, emailService, userRepository, cacheStorage);
const forgetPasswordSentOtp = new forgetPasswordSentOtp_1.ForgetPasswordSentOtp(userRepository, otpService, otpContentGenerator, emailService, cacheStorage);
const forgetPasswordVerifyOtpUseCase = new forgetPasswordVerifyOtpUseCase_1.ForgetPasswordVerifyOtpUseCase(cacheStorage, tokenService);
const forgetPasswordResetPasswordUseCase = new forgetPasswordResetPassword_1.ForgetPasswordResetPasswordUseCase(cacheStorage, userRepository, hashService);
const googleAuthUseCase = new userGoogleLoginUseCase_1.UserGoogleLoginUseCase(googleAuthService, userRepository, userProfileRepository);
//Controller
exports.userAuthController = new userAuthController_1.UserAuthController(registerUserUseCase, userSendOtpUseCase, verifyOtpUseCase, tokenCreationUseCase, userLoginUseCase, tokenValidationUseCase, resendOtpUseCase, forgetPasswordSentOtp, forgetPasswordVerifyOtpUseCase, forgetPasswordResetPasswordUseCase, googleAuthUseCase, jwtService);
exports.adminAuthController = new adminAuthController_1.AdminAuthController(adminLoginUseCase, tokenCreationUseCase);
/// Middleware
exports.authMiddleware = new authMiddleware_1.AuthMiddleware(jwtService, cacheStorage, userRepository);
